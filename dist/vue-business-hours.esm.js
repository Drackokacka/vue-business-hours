import e from"moment";import{ToggleButton as t}from"vue-js-toggle-button";export{ToggleButton}from"vue-js-toggle-button";import{FontAwesomeIcon as i}from"@fortawesome/vue-fontawesome";export{FontAwesomeIcon}from"@fortawesome/vue-fontawesome";import{library as n}from"@fortawesome/fontawesome-svg-core";import{faTimes as s}from"@fortawesome/free-solid-svg-icons";var o={props:{days:{type:Object,required:!0},name:{type:String,default:"business_hours"},type:{type:String,default:"datalist",validator:function(e){return-1!==["datalist","select"].indexOf(e)}},timeIncrement:{type:Number,default:30,validator:function(e){return-1!==[15,30,60].indexOf(e)}},color:{type:String,default:"#2779bd",validator:function(e){return"#"===e.charAt(0)}}}};var r=function(e,t,i,n,s,o,r,a,u,d){"boolean"!=typeof r&&(u=a,a=r,r=!1);var l,h="function"==typeof i?i.options:i;if(e&&e.render&&(h.render=e.render,h.staticRenderFns=e.staticRenderFns,h._compiled=!0,s&&(h.functional=!0)),n&&(h._scopeId=n),o?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,u(e)),e&&e._registeredComponents&&e._registeredComponents.add(o)},h._ssrRegister=l):t&&(l=r?function(){t.call(this,d(this.$root.$options.shadowRoot))}:function(e){t.call(this,a(e))}),l)if(h.functional){var c=h.render;h.render=function(e,t){return l.call(t),c(e,t)}}else{var m=h.beforeCreate;h.beforeCreate=m?[].concat(m,l):[l]}return i},a="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());var u=document.head||document.getElementsByTagName("head")[0],d={};var l=function(e){return function(e,t){return function(e,t){var i=a?t.media||"default":e,n=d[i]||(d[i]={ids:new Set,styles:[]});if(!n.ids.has(e)){n.ids.add(e);var s=t.source;if(t.map&&(s+="\n/*# sourceURL="+t.map.sources[0]+" */",s+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t.map))))+" */"),n.element||(n.element=document.createElement("style"),n.element.type="text/css",t.media&&n.element.setAttribute("media",t.media),u.appendChild(n.element)),"styleSheet"in n.element)n.styles.push(s),n.element.styleSheet.cssText=n.styles.filter(Boolean).join("\n");else{var o=n.ids.size-1,r=document.createTextNode(s),l=n.element.childNodes;l[o]&&n.element.removeChild(l[o]),l.length?n.element.insertBefore(r,l[o]):n.element.appendChild(r)}}}(e,t)}},h=r({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"business-hours-container"},e._l(e.days,function(t,n){return i("business-hours-day",{key:n,attrs:{day:n,hours:t,name:e.name,"time-increment":e.timeIncrement,type:e.type,color:e.color}})}),1)},staticRenderFns:[]},function(e){e&&e("data-v-d60fd436_0",{source:".business-hours-container[data-v-d60fd436]{display:block;width:100%;max-width:600px;font-family:-apple-system,Helvetica,Arial,sans-serif;font-size:15px;color:#3d4852}",map:void 0,media:void 0})},o,"data-v-d60fd436",!1,void 0,l,void 0),c={data:function(){return{validations:[],errors:{open:{invalidInput:'Please enter an opening time in the 12 hour format (ie. 08:00 AM). You may also enter "24 hours".',greaterThanNext:"Please enter an opening time that is before the closing time.",lessThanPrevious:"Please enter an opening time that is after the previous closing time.",midnightNotLast:"Midnight can only be selected for the day's last closing time."},close:{invalidInput:'Please enter a closing time in the 12 hour format (ie. 05:00 PM). You may also enter "24 hours" or "Midnight".',lessThanPrevious:"Please enter a closing time that is after the opening time.",greaterThanNext:"Please enter a closing time that is before the next opening time.",midnightNotLast:"Midnight can only be selected for the day's last closing time."}}}},created:function(){this.runValidations()},computed:{},methods:{defaultValidation:function(){return{invalidInput:!1,greaterThanNext:!1,lessThanPrevious:!1,midnightNotLast:!1}},defaultValidations:function(){return{anyErrors:!1,open:this.defaultValidation(),close:this.defaultValidation()}},isValidInput:function(e){return this.isValidBackendTime(e)||"2400"===e||"24hrs"===e||""===e},resetValidations:function(){var e=this,t=[];this.hours.forEach(function(i,n){t[n]=e.defaultValidations()}),this.validations=t},runValidations:function(){var e=this,t=1;this.resetValidations(),this.hours.forEach(function(i,n){e.runValidation(i.open,n,t,"open"),t++,e.runValidation(i.close,n,t,"close"),t++}),this.updateAnyErrors()},runValidation:function(e,t,i,n){this.isValidBackendTime(e)&&(this.validations[t][n]=this.runInputValidation(e,t,i,this.totalInputs)),this.validations[t][n].invalidInput=!this.isValidInput(e),this.updateAdjacentValidations(t,n,i)},runInputValidation:function(e,t,i,n){var s=this.getPrevious(this.hours,t,i),o=this.getNext(this.hours,t,i,n),r=this.defaultValidation();return r.midnightNotLast="2400"===e&&!this.isLastInput(i,n),void 0===s?r.greaterThanNext=e>=o&&""!==o:void 0===o?r.lessThanPrevious=e<=s&&""!==s:(r.lessThanPrevious=e<=s&&""!==s,r.greaterThanNext=e>=o&&""!==o),r},updateAdjacentValidations:function(e,t,i){var n=e-1,s=e+1,o=this.validations[e][t],r=this.getPrevious(this.validations,e,i),a=this.getNext(this.validations,e,i,this.totalInputs);void 0!==r&&(o.lessThanPrevious?r.greaterThanNext=!0:o.lessThanPrevious||(r.greaterThanNext=!1)),void 0!==a&&(o.greaterThanNext?a.lessThanPrevious=!0:o.greaterThanNext||(a.lessThanPrevious=!1)),this.isFirstInput(i)||"open"!==t?"close"===t&&(this.validations[e].open=r):this.validations[n].close=r,this.isLastInput(i,this.totalInputs)||"close"!==t?"open"===t&&(this.validations[e].close=a):this.validations[s].open=a},updateAnyErrors:function(){var e=this;this.validations.forEach(function(t,i){return e.validations[i].anyErrors=e.anyErrors(t)})},anyErrors:function(e){return!(!this.anyError(e.open)&&!this.anyError(e.close))},anyError:function(e){return Object.keys(e).some(function(t){return!0===e[t]})},activeErrors:function(e){var t=this.validations[e],i=[];return Object.keys(t).forEach(function(e){if("object"==typeof t[e]){var n=t[e];Object.keys(n).filter(function(e){return!0===n[e]}).forEach(function(t){i.push({whichTime:e,error:t})})}}),i},errorMessage:function(e,t){return this.errors[e][t]}}},m=require("uniqid"),p=r({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("transition-group",{tag:"div",attrs:{name:"fade"}},e._l(e.hours,function(t,n){var s=t.open,o=t.close,r=t.id;return t.isOpen,i("div",{key:r},[i("div",{staticClass:"flex-table row",attrs:{role:"rowgroup"}},[i("div",{staticClass:"flex-row day",attrs:{role:"cell"}},[e.showDay(n)?i("div",[e._v(e._s(e.titleCase(e.day)))]):e._e()]),e._v(" "),i("div",{staticClass:"flex-row toggle",attrs:{role:"cell"}},[e.showDay(n)?i("ToggleButton",{attrs:{value:e.anyOpen,sync:!0,labels:{checked:"Open",unchecked:"Closed"},color:e.color,width:75,height:25,"font-size":12},on:{change:function(t){e.toggleOpen(),e.resetHours(),e.runValidations()}}}):e._e()],1),e._v(" "),i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.isOpenToday,expression:"isOpenToday"}],staticClass:"flex-row hours open",attrs:{role:"cell"}},["select"===e.type?i("BusinessHoursSelect",{attrs:{name:e.name,"input-num":e.inputNum("open",n),"total-inputs":e.totalInputs,day:e.day,hours:e.hours,"time-increment":e.timeIncrement,index:n,"selected-time":s},on:{"input-change":function(t){return e.onChangeEventHandler("open",n,t)}}}):e._e(),e._v(" "),"datalist"===e.type?i("BusinessHoursDatalist",{attrs:{name:e.name,"input-num":e.inputNum("open",n),"total-inputs":e.totalInputs,day:e.day,hours:e.hours,"time-increment":e.timeIncrement,index:n,"selected-time":s,"any-error":e.anyError(e.validations[n].open)},on:{"input-change":function(t){return e.onChangeEventHandler("open",n,t)}}}):e._e()],1)]),e._v(" "),i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.isOpenToday,expression:"isOpenToday"}],staticClass:"flex-row dash",attrs:{role:"cell"}},[e._v("-")])]),e._v(" "),i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.isOpenToday,expression:"isOpenToday"}],staticClass:"flex-row hours close",attrs:{role:"cell"}},["select"===e.type?i("BusinessHoursSelect",{attrs:{name:e.name,"input-num":e.inputNum("close",n),"total-inputs":e.totalInputs,day:e.day,hours:e.hours,"time-increment":e.timeIncrement,index:n,"selected-time":o},on:{"input-change":function(t){return e.onChangeEventHandler("close",n,t)}}}):e._e(),e._v(" "),"datalist"===e.type?i("BusinessHoursDatalist",{attrs:{name:e.name,"input-num":e.inputNum("close",n),"total-inputs":e.totalInputs,day:e.day,hours:e.hours,"time-increment":e.timeIncrement,index:n,"any-error":e.anyError(e.validations[n].close),"updated-validations":e.validations[n].close,"selected-time":o},on:{"input-change":function(t){return e.onChangeEventHandler("close",n,t)}}}):e._e()],1)]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.isOpenToday,expression:"isOpenToday"}],staticClass:"flex-row remove",attrs:{role:"cell"}},[e.showRemoveButton()?i("button",{staticClass:"font-awesome-button",attrs:{type:"button"},on:{click:function(t){return e.removeRow(n)}}},[i("FontAwesomeIcon",{staticClass:"fa-sm",attrs:{icon:"times"}})],1):e._e()]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.isOpenToday,expression:"isOpenToday"}],staticClass:"flex-row add",attrs:{role:"cell"}},[e.showAddButton(n)?i("button",{staticClass:"add-hours",style:{color:e.color},attrs:{type:"button"},on:{click:function(t){return e.addRow()}}},[e._v("Add hours")]):e._e()])],1),e._v(" "),e.validations[n].anyErrors?i("ul",{staticClass:"time-errors"},e._l(e.activeErrors(n),function(t){var n=t.whichTime,s=t.error;return i("li",{key:n+"."+s},[e._v(e._s(e.errorMessage(n,s)))])}),0):e._e()])}),0)},staticRenderFns:[]},function(e){e&&e("data-v-4664d39c_0",{source:".flex-table[data-v-4664d39c]{display:flex;flex-flow:row nowrap;align-items:center;margin:.75em 0;height:45px}.flex-row[data-v-4664d39c]{width:calc(100% / 6);padding-right:7px}.flex-row[data-v-4664d39c] input,.flex-row[data-v-4664d39c] select{margin:1px;padding:3px 5px;width:100px;height:28px;font-size:14px;line-height:28px;vertical-align:middle;border:1px solid #d5d5d5;box-sizing:border-box}.flex-row.toggle[data-v-4664d39c]{width:96px}.flex-row.dash[data-v-4664d39c]{padding-right:7px;width:5px}.row-container[data-v-4664d39c]{flex-direction:column}.row[data-v-4664d39c]{flex-direction:row}.remove[data-v-4664d39c]{display:flex;justify-content:center;width:50px}label.vue-js-switch[data-v-4664d39c]{margin-bottom:0}button.add-hours[data-v-4664d39c],button.font-awesome-button[data-v-4664d39c]{height:30px;background-color:transparent;border-color:transparent;border-style:none;border-width:0;padding:0;cursor:pointer}button.add-hours[data-v-4664d39c]:focus,button.font-awesome-button[data-v-4664d39c]:focus{outline:0}button.font-awesome-button[data-v-4664d39c]{width:30px;font-size:24px}button.add-hours[data-v-4664d39c]{font-size:14px;font-weight:700}.fa-times[data-v-4664d39c]{color:#3d4852}.fade-enter-active[data-v-4664d39c],.fade-leave-active[data-v-4664d39c]{transition:opacity .2s ease}.fade-enter[data-v-4664d39c],.fade-leave-to[data-v-4664d39c]{opacity:0}.time-errors[data-v-4664d39c]{margin:0;padding:0;font-size:12px;color:#e3342f;list-style:none}.time-errors li[data-v-4664d39c]{margin-bottom:6px}",map:void 0,media:void 0})},{mixins:[c],props:{day:{type:String,required:!0},hours:{type:Array,required:!0},name:{type:String,required:!0},timeIncrement:{type:Number,required:!0},type:{type:String,required:!0},color:{type:String,required:!0}},computed:{totalInputs:function(){return 2*this.hours.length},isOpenToday:function(){return this.hours[0].isOpen},anyOpen:function(){return this.hours.some(function(e){return!0===e.isOpen})}},methods:{onChangeEventHandler:function(e,t,i){return"24hrs"==(i=this.backendInputFormat(i))?(this.hours.splice(1),this.hours[0].open=this.hours[0].close=i,void this.runValidations()):"24hrs"!=this.hours[t].open&&"24hrs"!=this.hours[t].close||""!=i?!this.onlyOneRow(this.hours)&&""===i&&("open"===e&&""===this.hours[t].close||"close"===e&&""===this.hours[t].open)?(this.removeRow(t),void this.runValidations()):(this.hours[t][e]=i,void this.runValidations()):(this.hours[t].open=this.hours[t].close=i,void this.runValidations())},inputNum:function(e,t){return"open"===e?2*t+1:"close"===e?2*t+2:void 0},toggleOpen:function(){this.hours[0].isOpen=!this.hours[0].isOpen},resetHours:function(){this.hours.splice(1),this.hours[0].open=this.hours[0].close=""},addRow:function(){this.hours.push({id:m(),open:"",close:"",isOpen:!0}),this.runValidations()},removeRow:function(e){this.hours.splice(e,1),this.runValidations()},showDay:function(e){return!(e>0)},showRemoveButton:function(){return this.hours.length>1},showAddButton:function(e){return!(this.hours.length!==e+1||""===this.hours[e].open||""===this.hours[e].close||"24hrs"===this.hours[e].open||"24hrs"===this.hours[e].close||"select"===this.type&&15===this.timeIncrement&&"2345"===this.hours[e].close||"select"===this.type&&30===this.timeIncrement&&"2330"===this.hours[e].close||"select"===this.type&&60===this.timeIncrement&&"2300"===this.hours[e].close||"2400"===this.hours[e].close||!1!==this.validations[e].anyErrors)}}},"data-v-4664d39c",!1,void 0,l,void 0),f={data:function(){return{selected:this.selectedTime,times:[]}},props:{name:{type:String,required:!0},day:{type:String,required:!0},hours:{type:Array,required:!0},index:{type:Number,required:!0},inputNum:{type:Number,required:!0},totalInputs:{type:Number,required:!0},selectedTime:{type:String,required:!0},timeIncrement:{type:Number,required:!0}},created:function(){this.times=this.generateTimes(this.timeIncrement)},watch:{selectedTime:function(){this.selected=this.selectedTime}},computed:{whichTime:function(){return this.isEven(this.inputNum)?"close":"open"},defaultText:function(){return"open"===this.whichTime?"Opens":"Closes"},optionName:function(){return this.name+"["+this.day+"]["+this.index+"]["+this.whichTime+"]"},filteredTimes:function(){var e=this.getPrevious(this.hours,this.index,this.inputNum),t=this.getNext(this.hours,this.index,this.inputNum,this.totalInputs),i=this.times;return this.isFirstRow(this.index)||""!==e||(e=this.getPrevious(this.hours,this.index,this.inputNum-1)),this.isFirstInput(this.inputNum)?i=this.getFiltered("before",t,i):this.isLastInput(this.inputNum,this.totalInputs)?i=this.getFiltered("after",e,i):(i=this.getFiltered("before",t,i),i=this.getFiltered("after",e,i)),i},showMidnightOption:function(){return this.isLastRow(this.index,this.hours)&&"close"===this.whichTime&&"24hrs"!==this.hours[this.index].close}},filters:{formatTime:function(t){return e(t,"HHmm").format("hh:mm A")}},methods:{inputEventHandler:function(e){this.$emit("input-change",e.target.value)},generateTimes:function(t){var i="0000",n=[];do{n.push(i),i=e(i,"HHmm").add(t,"minutes").format("HHmm")}while("0000"!==i);return n},getFiltered:function(e,t,i){return this.isLastInput(this.inputNum,this.totalInputs)&&""===this.hours[this.index].open?((i=i.filter(function(e){return e>t})).shift(),i):""===t?i:("before"===e?i=i.filter(function(e){return e<t}):"after"===e&&(i=i.filter(function(e){return e>t})),i)}}},v=r({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("select",{directives:[{name:"model",rawName:"v-model",value:e.selected,expression:"selected"}],attrs:{name:e.optionName},on:{change:[function(t){var i=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.selected=t.target.multiple?i:i[0]},e.inputEventHandler]}},[i("option",{directives:[{name:"show",rawName:"v-show",value:e.isFirstRow(e.index)&&e.onlyOneRow(e.hours),expression:"isFirstRow(index) && onlyOneRow(hours)"}],attrs:{value:""}},[e._v(e._s(e.defaultText))]),e._v(" "),i("option",{directives:[{name:"show",rawName:"v-show",value:e.isFirstRow(e.index),expression:"isFirstRow(index)"}],attrs:{value:"24hrs"}},[e._v("24 hours")]),e._v(" "),e._l(e.filteredTimes,function(t){return i("option",{key:t,domProps:{value:t,selected:t==e.selected}},[e._v(e._s(e._f("formatTime")(t)))])}),e._v(" "),i("option",{directives:[{name:"show",rawName:"v-show",value:e.showMidnightOption,expression:"showMidnightOption"}],attrs:{value:"2400"}},[e._v("Midnight")])],2)},staticRenderFns:[]},void 0,{mixins:[f]},void 0,!1,void 0,void 0,void 0),g=r({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("input",{staticClass:"time-input",class:[e.anyError?"has-error":""],attrs:{type:"text",list:e.datalistID,placeholder:e.defaultText},domProps:{value:e.formattedTime},on:{change:e.inputEventHandler}}),e._v(" "),i("datalist",{attrs:{id:e.datalistID}},[e.isFirstRow(e.index)?i("option",[e._v("24 hours")]):e._e(),e._v(" "),e._l(e.filteredTimes,function(t){return i("option",{key:t},[e._v(e._s(e._f("formatTime")(t)))])}),e._v(" "),e.showMidnightOption?i("option",[e._v("Midnight")]):e._e()],2),e._v(" "),i("input",{attrs:{name:e.optionName,type:"hidden"},domProps:{value:e.selected}})])},staticRenderFns:[]},function(e){e&&e("data-v-c9b2c3f4_0",{source:".time-input.has-error[data-v-c9b2c3f4]{border:solid #e3342f 1px}",map:void 0,media:void 0})},{mixins:[f],props:{anyError:{type:Boolean,required:!0}},computed:{formattedTime:function(){return this.frontendInputFormat(this.selected)},datalistID:function(){return this.day+"-"+this.index+"-"+this.whichTime}}},"data-v-c9b2c3f4",!1,void 0,l,void 0),y=Object.freeze({BusinessHours:h,BusinessHoursDay:p,BusinessHoursSelect:v,BusinessHoursDatalist:g,ToggleButton:t,FontAwesomeIcon:i}),w={methods:{titleCase:function(e){for(var t=e.toLowerCase().split(" "),i=0;i<t.length;i++)t[i]=t[i].charAt(0).toUpperCase()+t[i].substring(1);return t.join(" ")},frontendTimeFormat:function(t){return e(t,"HHmm").format("hh:mm A")},backendTimeFormat:function(t){return e(t,"hh:mm A").format("HHmm")},isValidFrontendTime:function(t){return e(t,"hh:mm A",!0).isValid()},isValidBackendTime:function(t){return e(t,"HHmm",!0).isValid()},frontendInputFormat:function(e){return"24hrs"===e?e="24 hours":"2400"===e?e="Midnight":this.isValidBackendTime(e)?e=this.frontendTimeFormat(e):""===e&&(e=""),e},backendInputFormat:function(e){return"Midnight"===e||"midnight"===e?"2400":"24 hours"===e||"24 Hours"===e?"24hrs":this.isValidFrontendTime(e)?this.backendTimeFormat(e):e},isEven:function(e){return e%2==0},isFirstInput:function(e){return 1===e},isLastInput:function(e,t){return e===t},isFirstRow:function(e){return 0===e},isLastRow:function(e,t){return e===t.length-1},isMiddleRow:function(e,t){return!this.isFirstRow(e)&&!this.isLastRow(e,t)},onlyOneRow:function(e){return 1===e.length},getPrevious:function(e,t,i){if(1!==i)return this.isEven(i)?e[t].open:e[t-1].close},getNext:function(e,t,i,n){if(i!==n)return this.isEven(i)?e[t+1].open:e[t].close}}};n.add(s);var x={install:function e(t){e.installed||(e.installed=!0,Object.keys(y).forEach(function(e){t.component(e,y[e])}),t.mixin(w))}},_=null;"undefined"!=typeof window?_=window.Vue:"undefined"!=typeof global&&(_=global.Vue),_&&_.use(x);export default x;export{h as BusinessHours,g as BusinessHoursDatalist,p as BusinessHoursDay,v as BusinessHoursSelect};
